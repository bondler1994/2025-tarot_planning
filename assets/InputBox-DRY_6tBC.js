import{j as D,r as P,aA as M,aB as $,k as z,g as O,h as R,i as Q,s as A,v as w,P as j,aC as N,x,B as g,E as r,aw as F,ax as T,aD as U,f as G,y as _,Z as h,G as K,z as Z,A as H,a3 as J,R as L}from"./index-C_kASq2C.js";import{o as W,a as X}from"./QInput-Ddp81nCR.js";import{e as Y,b as k}from"./QBtn-xSKRSjJV.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ye=D({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(e,{slots:m,emit:l}){const v=O(),a=P(null);let s=0;const i=[];function y(t){const d=typeof t=="boolean"?t:e.noErrorFocus!==!0,S=++s,V=(n,o)=>{l(`validation${n===!0?"Success":"Error"}`,o)},E=n=>{const o=n.validate();return typeof o.then=="function"?o.then(u=>({valid:u,comp:n}),u=>({valid:!1,comp:n,err:u})):Promise.resolve({valid:o,comp:n})};return(e.greedy===!0?Promise.all(i.map(E)).then(n=>n.filter(o=>o.valid!==!0)):i.reduce((n,o)=>n.then(()=>E(o).then(u=>{if(u.valid===!1)return Promise.reject(u)})),Promise.resolve()).catch(n=>[n])).then(n=>{if(n===void 0||n.length===0)return S===s&&V(!0),!0;if(S===s){const{comp:o,err:u}=n[0];if(u!==void 0&&console.error(u),V(!1,o),d===!0){const C=n.find(({comp:q})=>typeof q.focus=="function"&&Y(q.$)===!1);C!==void 0&&C.comp.focus()}}return!1})}function c(){s++,i.forEach(t=>{typeof t.resetValidation=="function"&&t.resetValidation()})}function f(t){t!==void 0&&A(t);const d=s+1;y().then(S=>{d===s&&S===!0&&(e.onSubmit!==void 0?l("submit",t):t!==void 0&&t.target!==void 0&&typeof t.target.submit=="function"&&t.target.submit())})}function p(t){t!==void 0&&A(t),l("reset"),w(()=>{c(),e.autofocus===!0&&e.noResetFocus!==!0&&b()})}function b(){W(()=>{if(a.value===null)return;const t=a.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||a.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||a.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(a.value.querySelectorAll("[tabindex]"),d=>d.tabIndex!==-1);t!=null&&t.focus({preventScroll:!0})})}j(N,{bindComponent(t){i.push(t)},unbindComponent(t){const d=i.indexOf(t);d!==-1&&i.splice(d,1)}});let I=!1;return M(()=>{I=!0}),$(()=>{I===!0&&e.autofocus===!0&&b()}),z(()=>{e.autofocus===!0&&b()}),Object.assign(v.proxy,{validate:y,resetValidation:c,submit:f,reset:p,focus:b,getValidationComponents:()=>i}),()=>R("form",{class:"q-form",ref:a,onSubmit:f,onReset:p},Q(m.default))}}),ee={key:0,class:"valid-sign"},te={__name:"InputStatus",props:{signStatus:{type:String,required:!0,validator(e){return["pending","checked","error"].includes(e)}}},setup(e){return(m,l)=>e.signStatus==="pending"?(r(),x("div",ee)):e.signStatus==="checked"?(r(),g(k,{key:1,name:"check_circle",size:"24px",color:"positive"})):(r(),g(k,{key:2,name:"highlight_off",size:"24px",color:"negative"}))}},ne=B(te,[["__scopeId","data-v-77237b37"]]),ae={__name:"EditSign",emits:["update:disable"],setup(e,{emit:m}){const l=m;return(v,a)=>(r(),g(k,{class:"edit-btn",name:"img:/pencil.svg",size:"24px",color:"black",onClick:a[0]||(a[0]=s=>l("update:disable",!1))}))}},oe=B(ae,[["__scopeId","data-v-3d51a732"]]),se={class:"input-box row items-center"},ie={class:"input-box__label"},ue={class:"label"},re={class:"input-box__body"},le={key:0,class:"input-box__valid-sign"},de={key:0},ce={__name:"InputBox",props:F({title:{type:String,default:""},needSignSpace:{type:Boolean,default:!0},hasSign:{type:Boolean,default:!1},sign:{type:String,default:"validate"},rules:{type:Array,default:[]},hint:{type:String,default:""},type:{type:String,default:"text"},disable:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:F(["update:disable"],["update:modelValue"]),setup(e,{emit:m}){const l=m,v=T(e,"modelValue"),a=P(!1),s=U("qInputDOM"),i=G(()=>{var c;return a.value?(c=s.value)!=null&&c.hasError?"error":"checked":"pending"});function y(){a.value=!0}return(c,f)=>(r(),x("div",se,[_("div",ie,[_("div",ue,K(e.title),1)]),_("div",re,[Z(X,{type:e.type,standout:"",square:"",color:"white","bg-color":"grey-6",class:L(["input",e.sign!=="edit"||e.disable?"":"input--focus"]),modelValue:v.value,"onUpdate:modelValue":f[0]||(f[0]=p=>v.value=p),rules:e.rules,"lazy-rules":"",hint:e.hint,"no-error-icon":"",ref_key:"qInputDOM",ref:s,onBlurOnce:y,disable:e.disable},{append:H(()=>[J(c.$slots,"default",{},void 0,!0)]),_:3},8,["type","class","modelValue","rules","hint","disable"])]),e.needSignSpace?(r(),x("div",le,[e.hasSign?(r(),x("div",de,[e.sign==="validate"?(r(),g(ne,{key:0,signStatus:i.value},null,8,["signStatus"])):h("",!0),e.sign==="edit"?(r(),g(oe,{key:1,"onUpdate:disable":f[1]||(f[1]=p=>l("update:disable",p))})):h("",!0)])):h("",!0)])):h("",!0)]))}},be=B(ce,[["__scopeId","data-v-87e687c8"]]);export{oe as E,be as I,ye as Q};

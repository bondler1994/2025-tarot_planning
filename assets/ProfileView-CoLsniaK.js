import{b as g,Q as w}from"./QBtn-DEu7CPBx.js";import{e as R,p as j,a as _,r as V,I as h,Q as z,b as q}from"./InputBoxRadio-BJe3AB-O.js";import{Q as E,I as p}from"./InputBox-wcYxioTH.js";import{Q as N,a as Q}from"./QCard-XM7hpHeX.js";import{Q as A}from"./QInput-DhOjieaL.js";import{C as H}from"./ClosePopup-DW2Uuc9M.js";import{r as d,f as U,x as S,y as n,z as a,A as r,D as O,E as m,B as c,Z as C,C as i,V as F}from"./index-DRD2m_il.js";import{u as T}from"./profileStore-Co2FAmq6.js";import{t as Z}from"./tarotDiaryAPI-BLKX_40E.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-dark-Dbg09HpP.js";import"./use-render-cache-BuvjkNbm.js";import"./use-timeout-B2B1ggu3.js";import"./index-DW_MHI2K.js";const J={class:"profile column content-center"},K={class:"profile__form"},L={class:"row items-center justify-end"},M={key:1,class:"button-group row justify-center"},W={__name:"ProfileView",setup(X){O();const s=T(),o=d({name:s.profile.name,password:s.profile.password,gender:s.profile.gender,birthdate:s.profile.birthdate}),y=d(""),t=d({email:!0,name:!0,password:!0,gender:!0,birthdate:!0}),P=d([{label:"男",value:"male"},{label:"女",value:"female"},{label:"其他",value:"other"}]),f=U({get(){return o.value.birthdate.split("-").join("/")},set(u){o.value.birthdate=u.split("/").join("-")}}),k=U(()=>Object.values(t.value).some(u=>u===!1)),v=d(!1),b=d(!1);function x(){b.value=!0}async function B(){console.log(o.value);const u=o.value;try{const e=await Z.PUT("/api/auth/update",u);console.log(e),s.updateProfile(u),v.value=!0,x()}catch(e){console.log(e),v.value=!1,x()}}function D(){t.value={email:!0,name:!0,password:!0,gender:!0,birthdate:!0}}function I(){o.value={name:s.profile.name,password:s.profile.password,gender:s.profile.gender,birthdate:s.profile.birthdate},t.value={email:!0,name:!0,password:!0,gender:!0,birthdate:!0}}return(u,e)=>(m(),S("div",J,[e[14]||(e[14]=n("div",{class:"profile__title"},[n("div",{class:"title"},"會員資料")],-1)),n("div",K,[a(E,{class:"form",onSubmit:B},{default:r(()=>[a(p,{title:"帳號",hasSign:!1,modelValue:i(s).profile.email,"onUpdate:modelValue":e[0]||(e[0]=l=>i(s).profile.email=l),rules:[i(R)],disable:t.value.email},null,8,["modelValue","rules","disable"]),a(p,{title:"密碼",type:"password",hasSign:!0,sign:"edit",disable:t.value.password,"onUpdate:disable":e[1]||(e[1]=l=>t.value.password=l),modelValue:o.value.password,"onUpdate:modelValue":e[2]||(e[2]=l=>o.value.password=l),rules:[i(j)]},null,8,["disable","modelValue","rules"]),t.value.password?C("",!0):(m(),c(p,{key:0,type:"password",hasSign:!0,sign:"edit",modelValue:y.value,"onUpdate:modelValue":e[3]||(e[3]=l=>y.value=l),rules:[l=>i(_)(l,o.value.password)]},null,8,["modelValue","rules"])),a(p,{title:"暱稱",hasSign:!0,sign:"edit",disable:t.value.name,"onUpdate:disable":e[4]||(e[4]=l=>t.value.name=l),modelValue:o.value.name,"onUpdate:modelValue":e[5]||(e[5]=l=>o.value.name=l),rules:[i(V)]},null,8,["disable","modelValue","rules"]),a(h,{title:"性別",hasSign:!0,sign:"edit",modelValue:o.value.gender,"onUpdate:modelValue":e[6]||(e[6]=l=>o.value.gender=l),rules:[i(V)],options:P.value,disable:t.value.gender,"onUpdate:disable":e[7]||(e[7]=l=>t.value.gender=l)},null,8,["modelValue","rules","options","disable"]),a(p,{title:"生日",hasSign:!0,sign:"edit",modelValue:f.value,"onUpdate:modelValue":e[9]||(e[9]=l=>f.value=l),rules:[i(V)],disable:t.value.birthdate,"onUpdate:disable":e[10]||(e[10]=l=>t.value.birthdate=l)},{default:r(()=>[a(g,{name:"event",class:"cursor-pointer",size:"20px"},{default:r(()=>[a(z,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:r(()=>[a(q,{modelValue:f.value,"onUpdate:modelValue":e[8]||(e[8]=l=>f.value=l)},{default:r(()=>[n("div",L,[F(a(w,{label:"確定",color:"primary",flat:""},null,512),[[H]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","rules","disable"]),k.value?(m(),S("div",M,[a(w,{class:"button",label:"取消",color:"grey-2",unelevated:"",onClick:I}),a(w,{class:"button",label:"確認",type:"submit",color:"grey-7",unelevated:""})])):C("",!0)]),_:1})]),a(A,{modelValue:b.value,"onUpdate:modelValue":e[11]||(e[11]=l=>b.value=l),position:"top",onHide:D},{default:r(()=>[a(N,{style:{width:"350px"}},{default:r(()=>[v.value?(m(),c(Q,{key:0,class:"row items-center no-wrap"},{default:r(()=>[a(g,{class:"q-pr-xs",name:"check_circle",size:"sm",color:"positive"}),e[12]||(e[12]=n("div",{class:"text-weight-bold"},"更新成功",-1))]),_:1})):(m(),c(Q,{key:1,class:"row items-center no-wrap"},{default:r(()=>[a(g,{class:"q-pr-xs",name:"error",size:"sm",color:"negative"}),e[13]||(e[13]=n("div",{class:"text-weight-bold"},"連線失敗",-1))]),_:1}))]),_:1})]),_:1},8,["modelValue"])]))}},me=G(W,[["__scopeId","data-v-2b4cc51c"]]);export{me as default};

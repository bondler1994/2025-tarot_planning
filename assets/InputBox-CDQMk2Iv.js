import{c as M,r as A,aE as P,aF as D,S as O,g as R,h as z,b as Q,aG as w,s as F,U as N,n as T,aH as U,_ as I,q as x,B as g,A as r,E as k,aB as $,aC as j,aI as G,a as H,v as _,T as h,R as K,t as J,x as L,$ as W,y as X}from"./index-CSCzfQmP.js";import{o as Y,a as Z}from"./QInput-C29NEW-e.js";const ve=M({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(e,{slots:m,emit:l}){const v=R(),a=A(null);let o=0;const i=[];function y(t){const d=typeof t=="boolean"?t:e.noErrorFocus!==!0,S=++o,E=(n,s)=>{l(`validation${n===!0?"Success":"Error"}`,s)},V=n=>{const s=n.validate();return typeof s.then=="function"?s.then(u=>({valid:u,comp:n}),u=>({valid:!1,comp:n,err:u})):Promise.resolve({valid:s,comp:n})};return(e.greedy===!0?Promise.all(i.map(V)).then(n=>n.filter(s=>s.valid!==!0)):i.reduce((n,s)=>n.then(()=>V(s).then(u=>{if(u.valid===!1)return Promise.reject(u)})),Promise.resolve()).catch(n=>[n])).then(n=>{if(n===void 0||n.length===0)return S===o&&E(!0),!0;if(S===o){const{comp:s,err:u}=n[0];if(u!==void 0&&console.error(u),E(!1,s),d===!0){const C=n.find(({comp:q})=>typeof q.focus=="function"&&w(q.$)===!1);C!==void 0&&C.comp.focus()}}return!1})}function c(){o++,i.forEach(t=>{typeof t.resetValidation=="function"&&t.resetValidation()})}function f(t){t!==void 0&&F(t);const d=o+1;y().then(S=>{d===o&&S===!0&&(e.onSubmit!==void 0?l("submit",t):t!==void 0&&t.target!==void 0&&typeof t.target.submit=="function"&&t.target.submit())})}function p(t){t!==void 0&&F(t),l("reset"),N(()=>{c(),e.autofocus===!0&&e.noResetFocus!==!0&&b()})}function b(){Y(()=>{if(a.value===null)return;const t=a.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||a.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||a.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(a.value.querySelectorAll("[tabindex]"),d=>d.tabIndex!==-1);t!=null&&t.focus({preventScroll:!0})})}T(U,{bindComponent(t){i.push(t)},unbindComponent(t){const d=i.indexOf(t);d!==-1&&i.splice(d,1)}});let B=!1;return P(()=>{B=!0}),D(()=>{B===!0&&e.autofocus===!0&&b()}),O(()=>{e.autofocus===!0&&b()}),Object.assign(v.proxy,{validate:y,resetValidation:c,submit:f,reset:p,focus:b,getValidationComponents:()=>i}),()=>z("form",{class:"q-form",ref:a,onSubmit:f,onReset:p},Q(m.default))}}),ee={key:0,class:"valid-sign"},te={__name:"InputStatus",props:{signStatus:{type:String,required:!0,validator(e){return["pending","checked","error"].includes(e)}}},setup(e){return(m,l)=>e.signStatus==="pending"?(r(),x("div",ee)):e.signStatus==="checked"?(r(),g(k,{key:1,name:"check_circle",size:"24px",color:"positive"})):(r(),g(k,{key:2,name:"highlight_off",size:"24px",color:"negative"}))}},ne=I(te,[["__scopeId","data-v-77237b37"]]),ae={__name:"EditSign",emits:["update:disable"],setup(e,{emit:m}){const l=m;return(v,a)=>(r(),g(k,{class:"edit-btn",name:"img:/pencil.svg",size:"24px",color:"black",onClick:a[0]||(a[0]=o=>l("update:disable",!1))}))}},se=I(ae,[["__scopeId","data-v-3d51a732"]]),oe={class:"input-box row items-center"},ie={class:"input-box__label"},ue={class:"label"},re={class:"input-box__body"},le={key:0,class:"input-box__valid-sign"},de={key:0},ce={__name:"InputBox",props:$({title:{type:String,default:""},needSignSpace:{type:Boolean,default:!0},hasSign:{type:Boolean,default:!1},sign:{type:String,default:"validate"},rules:{type:Array,default:[]},hint:{type:String,default:""},type:{type:String,default:"text"},disable:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:$(["update:disable"],["update:modelValue"]),setup(e,{emit:m}){const l=m,v=j(e,"modelValue"),a=A(!1),o=G("qInputDOM"),i=H(()=>{var c;return a.value?(c=o.value)!=null&&c.hasError?"error":"checked":"pending"});function y(){a.value=!0}return(c,f)=>(r(),x("div",oe,[_("div",ie,[_("div",ue,K(e.title),1)]),_("div",re,[J(Z,{type:e.type,standout:"",square:"",color:"white","bg-color":"grey-6",class:X(["input",e.sign!=="edit"||e.disable?"":"input--focus"]),modelValue:v.value,"onUpdate:modelValue":f[0]||(f[0]=p=>v.value=p),rules:e.rules,"lazy-rules":"",hint:e.hint,"no-error-icon":"",ref_key:"qInputDOM",ref:o,onBlurOnce:y,disable:e.disable},{append:L(()=>[W(c.$slots,"default",{},void 0,!0)]),_:3},8,["type","class","modelValue","rules","hint","disable"])]),e.needSignSpace?(r(),x("div",le,[e.hasSign?(r(),x("div",de,[e.sign==="validate"?(r(),g(ne,{key:0,signStatus:i.value},null,8,["signStatus"])):h("",!0),e.sign==="edit"?(r(),g(se,{key:1,"onUpdate:disable":f[1]||(f[1]=p=>l("update:disable",p))})):h("",!0)])):h("",!0)])):h("",!0)]))}},ge=I(ce,[["__scopeId","data-v-87e687c8"]]);export{se as E,ge as I,ve as Q};
